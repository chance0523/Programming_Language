<!DOCTYPE html>

<html lang="en">

<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>

<body>

    <div class="container">
        <h2>Form Validation Register</h2>
        <form novalidate>
            <div class="form-group">
                <label for="userName">Username:</label>
                <input type="text" class="form-control" id="userName" placeholder="Enter userName" name="userName" required>
                <div class="valid-feedback">Valid.</div>
                <div class="invalid-feedback">Please fill out this field.</div>
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" class="form-control" id="password" placeholder="Enter password" name="password" required>
                <div class="valid-feedback">Valid.</div>
                <div class="invalid-feedback">Please fill out this field.</div>
            </div>
            <div class="form-group">
                <label for="password2">Password Confirm:</label>
                <input type="password" class="form-control" id="password2" placeholder="Confirm password" name="password2" required>
                <div class="valid-feedback">Valid.</div>
                <div class="invalid-feedback">Please fill out this field.</div>
            </div>
            <div class="form-group">
                <label for="phone">Phone:</label>
                <input type="text" class="form-control" id="phone" placeholder="Enter phone" name="phone" required>
                <div class="valid-feedback">Valid.</div>
                <div class="invalid-feedback">Please fill out this field.</div>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="text" class="form-control" id="email" placeholder="Enter email" name="email" required>
                <div class="valid-feedback">Valid.</div>
                <div class="invalid-feedback">Please fill out this field.</div>
            </div>
        </form>
        <button id="btnRegister" class="btn btn-primary">Register</button>

    </div>

</body>

<script>
    $(document).ready(function() {

        $("#userName").focus();

        // manually check
        $("#userName").blur(function() {
            if (validateUserName($(this))) {
                $(this).removeClass("is-invalid").addClass('is-valid');
            } else {
                $(this).removeClass("is-valid").addClass('is-invalid');
            }
        });

        $("#password").blur(function() {
            if (validatePassword($(this))) {
                $(this).removeClass("is-invalid").addClass('is-valid');
            } else {
                $(this).removeClass("is-valid").addClass('is-invalid');
            }
        });

        $("#password2").blur(function() {
            if (validatePassword2($(this))) {
                $(this).removeClass("is-invalid").addClass('is-valid');
            } else {
                $(this).removeClass("is-valid").addClass('is-invalid');
            }
        });

        $("#phone").blur(function() {
            if (validatePhone($(this))) {
                $(this).removeClass("is-invalid").addClass('is-valid');
            } else {
                $(this).removeClass("is-valid").addClass('is-invalid');
            }
        });

        $("#email").blur(function() {
            if (validateEmail($(this))) {
                $(this).removeClass("is-invalid").addClass('is-valid');
            } else {
                $(this).removeClass("is-valid").addClass('is-invalid');
            }
        });

        $(':input').focus(function() {
            $(this).removeClass('is-valid is-invalid');
        });

        //submit
        $("#btnRegister").click(function() {
            if ($("form").find(".is-invalid").length > 0) {
                alert("입력이 올바르지 않습니다.")
            } else {
                // 전송
            }
        });

    })

    function validateUserName(userName) {
        if (userName.val().length >= 8) return true;
        else return false;
    }

    function validatePassword(password) {
        if (password.val().length >= 4) return true;
        else return false;
    }

    function validatePassword2(password2) {
        if (password2.val() == $("#password").val()) return true;
        else return false;
    }

    function validatePhone(phone) {
        // \d 숫자
        // {3,4} 3개 ~ 4개
        let regexp = /^\d{3}-\d{3,4}-\d{4}$/;
        if (regexp.test(phone.val())) return true;
        else return false;
    }

    function validateEmail(email) {
        // ^ 시작일치, $ 끝 일치
        // {2, 3} 2개 ~ 3개
        // * 0회 이상, + 1회 이상
        // [-.] - 또는 _ 또는 .
        // ? 없거나 1회
        let regexp = /^[0-9a-zA-Z]([-.]?[0-9a-zA-Z])@0-9a-zA-Z.[a-zA-Z]{2,3}$/i;
        if (regexp.test(email.val())) return true;
        else return false;
    }
</script>

</html>